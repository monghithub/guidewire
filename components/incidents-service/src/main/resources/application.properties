# =============================================================================
# Incidents Service - Quarkus Configuration
# =============================================================================

# HTTP
quarkus.http.port=8084
quarkus.application.name=incidents-service

# Datasource
quarkus.datasource.db-kind=postgresql
quarkus.datasource.jdbc.url=jdbc:postgresql://${DB_HOST:postgres}:${DB_PORT:5432}/incidents
quarkus.datasource.username=${DB_USER:incidents}
quarkus.datasource.password=${DB_PASSWORD:incidents}
quarkus.datasource.jdbc.max-size=10
quarkus.datasource.jdbc.min-size=5

# Hibernate ORM
quarkus.hibernate-orm.database.generation=validate
quarkus.hibernate-orm.log.sql=true
quarkus.hibernate-orm.physical-naming-strategy=org.hibernate.boot.model.naming.CamelCaseToUnderscoresNamingStrategy

# Flyway
quarkus.flyway.migrate-at-start=true
quarkus.flyway.locations=db/migration

# Jackson
quarkus.jackson.serialization-inclusion=non-null

# Kafka - Incident Created Channel
mp.messaging.incoming.incident-created-in.connector=smallrye-kafka
mp.messaging.incoming.incident-created-in.topic=incidents.incident-created
mp.messaging.incoming.incident-created-in.group.id=incidents-service-group
mp.messaging.incoming.incident-created-in.auto.offset.reset=earliest
mp.messaging.incoming.incident-created-in.enable.auto.commit=false
mp.messaging.incoming.incident-created-in.key.deserializer=org.apache.kafka.common.serialization.StringDeserializer
mp.messaging.incoming.incident-created-in.value.deserializer=io.apicurio.registry.serde.avro.AvroKafkaDeserializer
mp.messaging.incoming.incident-created-in.apicurio.registry.url=${APICURIO_REGISTRY_URL:http://apicurio:8080/apis/registry/v2}
mp.messaging.incoming.incident-created-in.apicurio.registry.auto-register=true
mp.messaging.incoming.incident-created-in.failure-strategy=ignore

# Kafka - Customer Registered Channel
mp.messaging.incoming.customer-registered-in.connector=smallrye-kafka
mp.messaging.incoming.customer-registered-in.topic=customers.customer-registered
mp.messaging.incoming.customer-registered-in.group.id=incidents-service-group
mp.messaging.incoming.customer-registered-in.auto.offset.reset=earliest
mp.messaging.incoming.customer-registered-in.enable.auto.commit=false
mp.messaging.incoming.customer-registered-in.key.deserializer=org.apache.kafka.common.serialization.StringDeserializer
mp.messaging.incoming.customer-registered-in.value.deserializer=io.apicurio.registry.serde.avro.AvroKafkaDeserializer
mp.messaging.incoming.customer-registered-in.apicurio.registry.url=${APICURIO_REGISTRY_URL:http://apicurio:8080/apis/registry/v2}
mp.messaging.incoming.customer-registered-in.apicurio.registry.auto-register=true
mp.messaging.incoming.customer-registered-in.failure-strategy=ignore

# Kafka bootstrap servers
kafka.bootstrap.servers=${KAFKA_BOOTSTRAP_SERVERS:kafka:9092}

# Health & Metrics
quarkus.smallrye-health.root-path=/q/health
quarkus.micrometer.export.prometheus.path=/q/metrics

# Logging
quarkus.log.level=INFO
quarkus.log.category."com.guidewire.incidents".level=DEBUG
quarkus.log.category."org.hibernate.SQL".level=DEBUG
